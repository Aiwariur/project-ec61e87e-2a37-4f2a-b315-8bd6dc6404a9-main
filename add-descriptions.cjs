const Database = require('better-sqlite3');
const path = require('path');

const dbPath = path.join(__dirname, 'parrot_shop.db');
const db = new Database(dbPath);

console.log('üìù –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏–π –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤...\n');

// –®–∞–±–ª–æ–Ω—ã –æ–ø–∏—Å–∞–Ω–∏–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
const descriptions = {
  '–ê—Ä–∞': '–ö—Ä—É–ø–Ω—ã–π —è—Ä–∫–∏–π –ø–æ–ø—É–≥–∞–π —Å –≤—ã—Å–æ–∫–∏–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–æ–º. –û—Ç–ª–∏—á–∞–µ—Ç—Å—è –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º –∏ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å—é –∫ –æ–±—É—á–µ–Ω–∏—é.',
  '–ê–º–∞–∑–æ–Ω': '–£–º–Ω—ã–π –∏ –æ–±—â–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ–ø—É–≥–∞–π —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞. –•–æ—Ä–æ—à–æ –ø–æ–¥–¥–∞–µ—Ç—Å—è –¥—Ä–µ—Å—Å–∏—Ä–æ–≤–∫–µ, –º–æ–∂–µ—Ç –Ω–∞—É—á–∏—Ç—å—Å—è –≥–æ–≤–æ—Ä–∏—Ç—å.',
  '–ñ–∞–∫–æ': '–û–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö —É–º–Ω—ã—Ö –ø–æ–ø—É–≥–∞–µ–≤ –≤ –º–∏—Ä–µ. –û–±–ª–∞–¥–∞–µ—Ç –≤—ã–¥–∞—é—â–∏–º–∏—Å—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—è–º–∏ –∫ –∏–º–∏—Ç–∞—Ü–∏–∏ —Ä–µ—á–∏.',
  '–≠–∫–ª–µ–∫—Ç—É—Å': '–°–ø–æ–∫–æ–π–Ω—ã–π –∏ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –ø–æ–ø—É–≥–∞–π —Å —è—Ä–∫–∏–º –æ–ø–µ—Ä–µ–Ω–∏–µ–º. –û—Ç–ª–∏—á–∞–µ—Ç—Å—è –º—è–≥–∫–∏–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º.',
  '–ö–∞–∫–∞–¥—É': '–≠–Ω–µ—Ä–≥–∏—á–Ω—ã–π –∏ –ª–∞—Å–∫–æ–≤—ã–π –ø–æ–ø—É–≥–∞–π. –û—á–µ–Ω—å –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ —Ö–æ–∑—è–∏–Ω—É, —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è.',
  '–ö–æ—Ä–µ–ª–ª–∞': '–ù–µ–±–æ–ª—å—à–æ–π –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –ø–æ–ø—É–≥–∞–π, –∏–¥–µ–∞–ª–µ–Ω –¥–ª—è –Ω–∞—á–∏–Ω–∞—é—â–∏—Ö. –õ–µ–≥–∫–æ –ø—Ä–∏—Ä—É—á–∞–µ—Ç—Å—è –∏ –æ–±—É—á–∞–µ—Ç—Å—è.',
  '–ö–æ—Ä–æ–ª–µ–≤—Å–∫–∏–π': '–ö—Ä–∞—Å–∏–≤—ã–π –ø–æ–ø—É–≥–∞–π —Å—Ä–µ–¥–Ω–µ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ —Å —è—Ä–∫–∏–º –æ–ø–µ—Ä–µ–Ω–∏–µ–º. –°–ø–æ–∫–æ–π–Ω—ã–π –∏ –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä.',
  '–°–µ–Ω–µ–≥–∞–ª—å—Å–∫–∏–π': '–ö–æ–º–ø–∞–∫—Ç–Ω—ã–π –ø–æ–ø—É–≥–∞–π —Å –∏–≥—Ä–∏–≤—ã–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º. –•–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è —Å–æ–¥–µ—Ä–∂–∞–Ω–∏—è –≤ –∫–≤–∞—Ä—Ç–∏—Ä–µ.',
  '–ê—Ä–∞—Ç–∏–Ω–≥–∞': '–Ø—Ä–∫–∏–π –∏ —ç–Ω–µ—Ä–≥–∏—á–Ω—ã–π –ø–æ–ø—É–≥–∞–π. –û—á–µ–Ω—å –æ–±—â–∏—Ç–µ–ª—å–Ω—ã–π, –ª—é–±–∏—Ç –∏–≥—Ä–∞—Ç—å –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å —Å –ª—é–¥—å–º–∏.',
  '–õ–æ—Ä–∏–∫–µ—Ç': '–ê–∫—Ç–∏–≤–Ω—ã–π –∏ –∫—Ä–∞—Å–æ—á–Ω—ã–π –ø–æ–ø—É–≥–∞–π. –û—Ç–ª–∏—á–∞–µ—Ç—Å—è –∏–≥—Ä–∏–≤—ã–º —Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º –∏ –ª—é–±–æ–≤—å—é –∫ –æ–±—â–µ–Ω–∏—é.',
  '–ú–æ–Ω–∞—Ö': '–£–º–Ω—ã–π –∏ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–π –ø–æ–ø—É–≥–∞–π –Ω–µ–±–æ–ª—å—à–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞. –•–æ—Ä–æ—à–æ –æ–±—É—á–∞–µ—Ç—Å—è –∏ –ø—Ä–∏–≤—è–∑—ã–≤–∞–µ—Ç—Å—è –∫ —Ö–æ–∑—è–∏–Ω—É.',
  '–û–∂–µ—Ä–µ–ª–æ–≤—ã–π': '–≠–ª–µ–≥–∞–Ω—Ç–Ω—ã–π –ø–æ–ø—É–≥–∞–π —Å —Ö–∞—Ä–∞–∫—Ç–µ—Ä–Ω—ã–º "–æ–∂–µ—Ä–µ–ª—å–µ–º". –£–º–Ω—ã–π –∏ —Å–ø–æ—Å–æ–±–Ω—ã–π –∫ –æ–±—É—á–µ–Ω–∏—é —Ä–µ—á–∏.',
  '–ü–∏—Ä—Ä—É—Ä–∞': '–ù–µ–±–æ–ª—å—à–æ–π –¥—Ä—É–∂–µ–ª—é–±–Ω—ã–π –ø–æ–ø—É–≥–∞–π —Å —è—Ä–∫–∏–º –æ–ø–µ—Ä–µ–Ω–∏–µ–º. –ò–≥—Ä–∏–≤—ã–π –∏ –æ–±—â–∏—Ç–µ–ª—å–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä.'
};

const products = db.prepare('SELECT id, name, category, description FROM products').all();

console.log(`üìä –í—Å–µ–≥–æ —Ç–æ–≤–∞—Ä–æ–≤: ${products.length}\n`);

let updatedCount = 0;
const updateStmt = db.prepare('UPDATE products SET description = ? WHERE id = ?');

const updateMany = db.transaction(() => {
  products.forEach(product => {
    // –ï—Å–ª–∏ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—É—Å—Ç–æ–µ –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–æ–±–µ–ª—ã
    if (!product.description || product.description.trim() === '') {
      const category = product.category;
      const newDescription = descriptions[category] || '–ö—Ä–∞—Å–∏–≤—ã–π —ç–∫–∑–æ—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–ø—É–≥–∞–π. –û—Ç–ª–∏—á–Ω—ã–π –≤—ã–±–æ—Ä –¥–ª—è –ª—é–±–∏—Ç–µ–ª–µ–π –ø—Ç–∏—Ü.';
      
      console.log(`‚úèÔ∏è  ID ${product.id}: "${product.name.substring(0, 50)}..."`);
      console.log(`   –ö–∞—Ç–µ–≥–æ—Ä–∏—è: ${category}`);
      console.log(`   –ù–æ–≤–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ: "${newDescription}"\n`);
      
      updateStmt.run(newDescription, product.id);
      updatedCount++;
    }
  });
});

updateMany();

console.log(`\n‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–æ —Ç–æ–≤–∞—Ä–æ–≤: ${updatedCount}`);
console.log(`üìä –£–∂–µ –∏–º–µ–ª–∏ –æ–ø–∏—Å–∞–Ω–∏–µ: ${products.length - updatedCount}\n`);

db.close();
console.log('‚úÖ –ì–æ—Ç–æ–≤–æ!');
